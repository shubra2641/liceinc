/* USER DASHBOARD MINIFIED JS - Optimized & Compressed */
(function(){'use strict';const $=(s,c=document)=>c.querySelector(s),$$=(s,c=document)=>c.querySelectorAll(s);const showNotification=(m,t='info')=>{const n=document.createElement('div');n.className=`user-notification user-notification-${t} show`;n.innerHTML=`<div class="user-notification-content"><div class="user-notification-icon"><i class="fas fa-${t==='success'?'check':t==='error'?'times':t==='warning'?'exclamation':'info'}-circle"></i></div><div class="user-notification-message">${m}</div><button class="user-notification-close" onclick="this.parentElement.parentElement.remove()"><i class="fas fa-times"></i></button></div>`;document.body.appendChild(n);setTimeout(()=>n.remove(),5000)};const setButtonLoading=(b,l)=>{const t=b.querySelector('.button-text, .user-btn-text'),s=b.querySelector('.button-loading, .user-btn-spinner');if(l){b.disabled=true;if(t)t.style.opacity='0';if(s)s.style.display='inline-block'}else{b.disabled=false;if(t)t.style.opacity='1';if(s)s.style.display='none'}};const validateInput=i=>{const v=i.value.trim(),t=i.type,r=i.hasAttribute('required');if(r&&!v)return'This field is required';if(t==='email'&&v&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v))return'Please enter a valid email address';if(t==='password'&&v&&v.length<6)return'Password must be at least 6 characters';return null};const showInputError=(i,m)=>{const g=i.closest('.form-field-group, .form-group');if(!g)return;const e=g.querySelector('.form-error, .user-form-error');if(e)e.remove();const d=document.createElement('div');d.className='form-error';d.innerHTML=`<i class="fas fa-exclamation-circle"></i> ${m}`;g.appendChild(d);i.classList.add('form-input-error')};const clearInputError=i=>{const g=i.closest('.form-field-group, .form-group');if(!g)return;const e=g.querySelector('.form-error, .user-form-error');if(e)e.remove();i.classList.remove('form-input-error')};const initializeDashboard=()=>{initializeTables();initializeForms();initializeTabs();initializeCopyButtons();initializeFilters();initializeMobileMenu();initializeProfileTabs();initializeLicenseStatus();initializeHashScrolling();initializeTableOfContents();initializeArticleFeatures()};const initializeAuth=()=>{initializePasswordToggles();initializeFormValidation();initializeFormLoading();initializeFormAnimations()};const initializePasswordToggles=()=>{const t=$$('[data-password-toggle]');t.forEach(toggle=>{const i=$(toggle.dataset.passwordToggle),s=$(toggle.dataset.showIcon),h=$(toggle.dataset.hideIcon);if(i&&s&&h)toggle.addEventListener('click',()=>togglePasswordVisibility(i,s,h))})};const togglePasswordVisibility=(i,s,h)=>{if(i.type==='password'){i.type='text';s.style.display='none';h.style.display='inline'}else{i.type='password';s.style.display='inline';h.style.display='none'}};const initializeFormValidation=()=>{const f=$$('.user-form, .register-form, .login-form');f.forEach(form=>{const i=$$('input, textarea, select',form);i.forEach(input=>{input.addEventListener('blur',()=>{const e=validateInput(input);if(e)showInputError(input,e);else clearInputError(input)});input.addEventListener('input',()=>{if(input.classList.contains('form-input-error')){const e=validateInput(input);if(!e)clearInputError(input)}})});form.addEventListener('submit',e=>{const i=$$('input[required], textarea[required], select[required]',form);let v=true;i.forEach(input=>{const e=validateInput(input);if(e){showInputError(input,e);v=false}});if(!v)e.preventDefault()})})};const initializeFormLoading=()=>{const f=$$('.user-form, .register-form, .login-form');f.forEach(form=>{form.addEventListener('submit',()=>{const b=form.querySelector('button[type="submit"], input[type="submit"]');if(b)setButtonLoading(b,true)})})};const initializeFormAnimations=()=>{const c=$$('.user-card, .user-stat-card, .user-action-card');c.forEach((card,index)=>card.style.animationDelay=`${index*0.1}s`)};const initializeTables=()=>{const c=$$('.table-container');c.forEach(addScrollIndicator)};const addScrollIndicator=c=>{const t=$('.user-table',c);if(!t)return;const checkScrollable=()=>{const s=t.scrollWidth>c.clientWidth;c.classList.toggle('scrollable',s)};checkScrollable();window.addEventListener('resize',checkScrollable)};const initializeForms=()=>{const f=$$('form');f.forEach(addFormValidation)};const addFormValidation=f=>{const i=$$('input, textarea, select',f);i.forEach(input=>{input.addEventListener('blur',()=>{const e=validateInput(input);if(e)showInputError(input,e);else clearInputError(input)})})};const initializeTabs=()=>{const b=$$('.tab-button');b.forEach(button=>{button.addEventListener('click',()=>{const t=button.dataset.tab;if(t)showTab(t)})})};const showTab=t=>{const tabs=$$('.tab-content'),buttons=$$('.tab-button');tabs.forEach(tab=>tab.classList.remove('active'));buttons.forEach(btn=>btn.classList.remove('active'));const a=$(`#${t}`),ab=$(`[data-tab="${t}"]`);if(a)a.classList.add('active');if(ab)ab.classList.add('active')};const initializeCopyButtons=()=>{const b=$$('.copy-btn, [data-copy]');b.forEach(button=>{button.addEventListener('click',e=>{e.preventDefault();const t=button.dataset.copy||button.textContent.trim();copyToClipboard(t,button)})})};const copyToClipboard=(t,b)=>{if(navigator.clipboard){navigator.clipboard.writeText(t).then(()=>showCopySuccess(b)).catch(()=>fallbackCopyTextToClipboard(t,b))}else{fallbackCopyTextToClipboard(t,b)}};const fallbackCopyTextToClipboard=(t,b)=>{const a=document.createElement('textarea');a.value=t;a.style.position='fixed';a.style.left='-999999px';a.style.top='-999999px';document.body.appendChild(a);a.focus();a.select();try{document.execCommand('copy');showCopySuccess(b)}catch(err){showCopyError(b)}document.body.removeChild(a)};const showCopySuccess=b=>{const o=b.innerHTML;b.innerHTML='<i class="fas fa-check"></i> Copied!';b.style.background='#10b981';setTimeout(()=>{b.innerHTML=o;b.style.background=''},2000)};const showCopyError=b=>{const o=b.innerHTML;b.innerHTML='<i class="fas fa-times"></i> Failed';b.style.background='#ef4444';setTimeout(()=>{b.innerHTML=o;b.style.background=''},2000)};const initializeFilters=()=>{initializeLicenseFilters();initializeInvoiceFilters();initializeTicketFilters()};const initializeLicenseFilters=()=>{const s=$('#licenseStatusFilter'),i=$('#licenseSearchInput');if(s&&i){const f=()=>filterLicenseTable(s,i);s.addEventListener('change',f);i.addEventListener('input',f)}};const filterLicenseTable=(s,i)=>{const t=$('.user-table');if(!t)return;const r=$$('tbody tr',t);const sv=s.value.toLowerCase(),iv=i.value.toLowerCase();r.forEach(row=>{const st=row.querySelector('.license-status-badge')?.textContent.toLowerCase()||'';const tx=row.textContent.toLowerCase();const sm=!sv||st.includes(sv);const im=!iv||tx.includes(iv);row.style.display=sm&&im?'':'none'})};const initializeInvoiceFilters=()=>{const s=$('#invoiceStatusFilter'),i=$('#invoiceSearchInput');if(s&&i){const f=()=>filterInvoiceTable(s,i);s.addEventListener('change',f);i.addEventListener('input',f)}};const filterInvoiceTable=(s,i)=>{const t=$('.user-table');if(!t)return;const r=$$('tbody tr',t);const sv=s.value.toLowerCase(),iv=i.value.toLowerCase();r.forEach(row=>{const st=row.querySelector('.invoice-status-badge')?.textContent.toLowerCase()||'';const tx=row.textContent.toLowerCase();const sm=!sv||st.includes(sv);const im=!iv||tx.includes(iv);row.style.display=sm&&im?'':'none'})};const initializeTicketFilters=()=>{const s=$('#ticketStatusFilter'),p=$('#ticketPriorityFilter'),i=$('#ticketSearchInput');if(s&&p&&i){const f=()=>filterTicketTable(s,p,i);s.addEventListener('change',f);p.addEventListener('change',f);i.addEventListener('input',f)}};const filterTicketTable=(s,p,i)=>{const t=$('.user-table');if(!t)return;const r=$$('tbody tr',t);const sv=s.value.toLowerCase(),pv=p.value.toLowerCase(),iv=i.value.toLowerCase();r.forEach(row=>{const st=row.querySelector('.ticket-status-badge')?.textContent.toLowerCase()||'';const pr=row.querySelector('.ticket-priority-badge')?.textContent.toLowerCase()||'';const tx=row.textContent.toLowerCase();const sm=!sv||st.includes(sv);const pm=!pv||pr.includes(pv);const im=!iv||tx.includes(iv);row.style.display=sm&&pm&&im?'':'none'})};const initializeTicketForm=()=>{const f=$('#ticketForm');if(!f)return;const b=$('button[type="submit"]',f);if(b)f.addEventListener('submit',()=>setButtonLoading(b,true))};const initializeHashScrolling=()=>{const h=window.location.hash;if(h){const e=$(h);if(e)setTimeout(()=>e.scrollIntoView({behavior:'smooth'}),100)}};const generateTableOfContents=()=>{const c=$('.article-content, .user-article-content');if(!c)return;const h=$$('h1, h2, h3, h4, h5, h6',c);if(h.length===0)return;const t=$('.article-toc-content, .user-toc');if(!t)return;const l=document.createElement('ul');l.className='toc-list';h.forEach((heading,index)=>{const id=heading.id||`heading-${index}`;heading.id=id;const li=document.createElement('li');li.className=`toc-item ${heading.tagName.toLowerCase()}`;const a=document.createElement('a');a.href=`#${id}`;a.textContent=heading.textContent;a.addEventListener('click',e=>{e.preventDefault();heading.scrollIntoView({behavior:'smooth'})});li.appendChild(a);l.appendChild(li)});t.appendChild(l)};const addScrollSpy=()=>{const i=$$('.toc-item a');if(i.length===0)return;const r=()=>i.forEach(item=>item.classList.remove('active'));const a=()=>{const s=window.scrollY+100;const h=$$('h1, h2, h3, h4, h5, h6');h.forEach((heading,index)=>{const n=h[index+1];const t=heading.offsetTop;const b=n?n.offsetTop:t+heading.offsetHeight;if(s>=t&&s<b){r();const item=$(`.toc-item a[href="#${heading.id}"]`);if(item)item.classList.add('active')}})};const u=()=>requestAnimationFrame(a);window.addEventListener('scroll',u);u()};const handlePrintFunctionality=()=>{const b=$('.print-btn, [data-print]');if(b)b.addEventListener('click',()=>window.print())};const handleShareFunctionality=()=>{const b=$('.share-btn, [data-share]');if(b)b.addEventListener('click',()=>{if(navigator.share){navigator.share({title:document.title,url:window.location.href})}else{navigator.clipboard.writeText(window.location.href).then(()=>showNotification('Link copied to clipboard!','success'))}})};const initializeTableOfContents=()=>{generateTableOfContents();addScrollSpy()};const initializeArticleFeatures=()=>{handlePrintFunctionality();handleShareFunctionality()};const initializeLicenseStatus=()=>{const f=$('#licenseCheckForm');if(!f)return;const b=$('button[type="submit"]',f),c=$('#licenseCheckFormCard'),l=$('#loadingSpinner'),d=$('#licenseDetails'),e=$('#errorMessage');const showForm=()=>{hideAll();if(c)c.classList.remove('hidden')};const showLoading=()=>{hideAll();if(l)l.classList.add('show');if(b)setButtonLoading(b,true)};const showDetails=data=>{hideAll();if(d){populateDetails(data);d.classList.add('show')}};const showError=m=>{hideAll();if(e){e.textContent=m;e.classList.add('show')}};const hideAll=()=>{[c,l,d,e].forEach(el=>{if(el){el.classList.add('hidden');el.classList.remove('show')}});if(b)setButtonLoading(b,false)};const populateDetails=data=>{const e={'licenseKey':data.license_key,'licenseStatus':data.status,'licenseType':data.type,'productName':data.product_name,'purchaseDate':data.purchase_date,'expiryDate':data.expiry_date,'domainLimit':data.domain_limit,'purchaseCode':data.purchase_code,'itemId':data.item_id,'buyerEmail':data.buyer_email};Object.entries(e).forEach(([id,value])=>{const el=$(`#${id}`);if(el)el.textContent=value});if(data.domains&&data.domains.length>0)updateDomains(data.domains);if(data.envato_data)updateEnvato(data.envato_data)};const updateDomains=domains=>{const l=$('.domains-list');if(!l)return;l.innerHTML=domains.map(d=>`<div class="domain-item"><div class="domain-info"><div class="domain-name"><i class="fas fa-globe"></i>${d.domain}</div><div class="domain-meta"><div class="domain-date"><i class="fas fa-calendar"></i>${d.registered_at}</div><div class="domain-status"><span class="status-dot ${d.status}"></span><span class="status-text">${d.status}</span></div></div></div></div>`).join('')};const updateEnvato=data=>{const s=$('.envato-data-section'),n=$('.envato-na-section');if(data&&Object.keys(data).length>0){if(s){s.classList.remove('hide');s.classList.add('show')}if(n){n.classList.add('hide');n.classList.remove('show')}const e={'envatoUsername':data.username,'envatoSales':data.sales,'envatoFollowers':data.followers,'envatoRating':data.rating};Object.entries(e).forEach(([id,value])=>{const el=$(`#${id}`);if(el)el.textContent=value})}else{if(s){s.classList.add('hide');s.classList.remove('show')}if(n){n.classList.remove('hide');n.classList.add('show')}}};const showHistory=()=>{const m=$('.license-history-modal');if(m){m.style.display='block';document.body.classList.add('modal-open');loadHistory()}};const hideHistory=()=>{const m=$('.license-history-modal');if(m){m.style.display='none';document.body.classList.remove('modal-open')}};const loadHistory=()=>{const c=$('.user-history-content');if(c){c.innerHTML='<div class="text-center p-4">Loading history...</div>';setTimeout(()=>{const h=[{type:'activation',title:'License Activated',description:'License was activated on example.com',date:'2024-01-15 10:30:00',ip:'192.168.1.1'},{type:'deactivation',title:'License Deactivated',description:'License was deactivated from example.com',date:'2024-01-14 15:45:00',ip:'192.168.1.1'}];c.innerHTML=h.map(item=>`<div class="history-item"><div class="history-item-icon ${item.type}"><i class="fas fa-${getIcon(item.type)}"></i></div><div class="history-item-content"><div class="history-item-title">${item.title}</div><div class="history-item-description">${item.description}</div><div class="history-item-meta"><span class="history-item-time">${item.date}</span><span class="history-item-ip">IP: ${item.ip}</span></div></div></div>`).join('')},1000)}};const getIcon=t=>{const i={'activation':'check-circle','deactivation':'times-circle','suspension':'exclamation-circle','renewal':'refresh'};return i[t]||'info-circle'};const exportHistory=()=>{const d=$('.user-history-content').textContent;const b=new Blob([d],{type:'text/plain'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='license-history.txt';a.click();URL.revokeObjectURL(u)};const copyToClipboard=(t,b)=>{if(navigator.clipboard){navigator.clipboard.writeText(t).then(()=>showCopySuccess(b)).catch(()=>fallbackCopy(t,b))}else{fallbackCopy(t,b)}};const fallbackCopy=(t,b)=>{const a=document.createElement('textarea');a.value=t;a.style.position='fixed';a.style.left='-999999px';a.style.top='-999999px';document.body.appendChild(a);a.focus();a.select();try{document.execCommand('copy');showCopySuccess(b)}catch(err){showCopyError(b)}document.body.removeChild(a)};const showCopySuccess=e=>{const o=e.textContent;e.textContent='Copied!';e.style.color='#10b981';setTimeout(()=>{e.textContent=o;e.style.color=''},2000)};const showCopyError=e=>{const o=e.textContent;e.textContent='Failed to copy';e.style.color='#ef4444';setTimeout(()=>{e.textContent=o;e.style.color=''},2000)};const handleEnvato=data=>{if(data.envato_data)updateEnvato(data.envato_data);else{const s=$('.envato-data-section'),n=$('.envato-na-section');if(s)s.classList.add('hide');if(n)n.classList.remove('hide')}};const viewDomain=d=>showNotification(`Viewing history for ${d}`,'info');const handleCheck=()=>{if(!f)return;f.addEventListener('submit',async e=>{e.preventDefault();showLoading();const d=new FormData(f);const k=d.get('license_key');if(!k){showError('Please enter a license key');return}try{const r=await fetch(f.action,{method:'POST',body:d,headers:{'X-CSRF-TOKEN':document.querySelector('meta[name="csrf-token"]').content}});const data=await r.json();if(data.success){showDetails(data.license);handleEnvato(data.license)}else{showError(data.message||'License not found')}}catch(error){showError('An error occurred while checking the license')}})};handleCheck();window.showLicenseHistory=showHistory;window.hideLicenseHistory=hideHistory;window.exportLicenseHistory=exportHistory;window.copyLicenseKey=()=>copyToClipboard('',document.getElementById('licenseKey'));window.copyPurchaseCode=()=>copyToClipboard('',document.getElementById('purchaseCode'));window.viewDomainHistory=viewDomain};const initializeMobileMenu=()=>{const t=$('[data-mobile-menu-toggle]'),m=$('[data-mobile-menu]'),b=$('.mobile-menu-backdrop'),c=$('.mobile-menu-close');if(!t||!m)return;const toggle=()=>{const o=m.classList.contains('active');if(o)close();else open()};const open=()=>{m.classList.add('active');if(b)b.classList.add('active');document.body.classList.add('mobile-menu-open');document.addEventListener('keydown',handleEscape)};const close=()=>{m.classList.remove('active');if(b)b.classList.remove('active');document.body.classList.remove('mobile-menu-open');document.removeEventListener('keydown',handleEscape)};const handleEscape=e=>{if(e.key==='Escape')close()};t.addEventListener('click',toggle);if(c)c.addEventListener('click',close);if(b)b.addEventListener('click',close);const l=$$('.mobile-nav-link');l.forEach(link=>link.addEventListener('click',close))};const initializeProfileTabs=()=>{const b=$$('.tab-button');b.forEach(button=>{button.addEventListener('click',()=>{const t=button.dataset.tab;if(t)showTab(t)})})};document.addEventListener('DOMContentLoaded',function(){if($('.user-dashboard-container'))initializeDashboard();if($('.user-form, .register-form, .login-form'))initializeAuth();initializeTicketForm();const fs=document.querySelector('meta[name="flash-success"]'),fe=document.querySelector('meta[name="flash-error"]'),fw=document.querySelector('meta[name="flash-warning"]'),fi=document.querySelector('meta[name="flash-info"]');if(fs)showNotification(fs.content,'success');if(fe)showNotification(fe.content,'error');if(fw)showNotification(fw.content,'warning');if(fi)showNotification(fi.content,'info')});window.showNotification=showNotification;window.setButtonLoading=setButtonLoading;window.togglePasswordVisibility=togglePasswordVisibility;window.showTab=showTab;window.copyToClipboard=copyToClipboard})();
